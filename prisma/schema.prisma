generator client {
  provider = "prisma-client"
  output   = "./generated/prisma"
}

datasource db {
  provider = "postgresql"
}


model User {
  id        String    @id @default(cuid())
  email     String    @unique
  password  String
  name      String?
  role      String    @default("USER") // ADMIN, USER
  isApproved Boolean  @default(false)
  createdAt DateTime  @default(now())
  updatedAt DateTime  @updatedAt
  posts     Post[]
  comments  Comment[]
  postLikes  PostLike[]
  postScraps PostScrap[]
}

model Product {
  id        String   @id @default(cuid())
  title     String
  content   String // Lexical JSON
  contentMarkdown String?
  category  String // CASINO, NIGHTLIFE, GOLF, HOTEL, ETC
  categoryId String?
  categoryRef Category? @relation(fields: [categoryId], references: [id])
  contentType String @default("RICH")
  htmlContent String?
  imageUrl  String?
  price     String?
  isVisible Boolean  @default(true)
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model Post {
  id        String    @id @default(cuid())
  title     String
  content   String // Lexical JSON
  contentMarkdown String?
  type      String    // FREE, REVIEW
  authorId  String
  author    User      @relation(fields: [authorId], references: [id])
  comments  Comment[]
  viewCount Int       @default(0)
  isPinned  Boolean   @default(false)
  isSecret  Boolean   @default(false)
  likeCount Int       @default(0)
  scrapCount Int      @default(0)
  attachments PostAttachment[]
  likes     PostLike[]
  scraps    PostScrap[]
  createdAt DateTime  @default(now())
  updatedAt DateTime  @updatedAt
}

model PostAttachment {
  id        String   @id @default(cuid())
  postId    String
  post      Post     @relation(fields: [postId], references: [id], onDelete: Cascade)
  url       String
  name      String?
  type      String?
  size      Int?
  createdAt DateTime @default(now())
}

model PostLike {
  id        String   @id @default(cuid())
  postId    String
  post      Post     @relation(fields: [postId], references: [id], onDelete: Cascade)
  userId    String
  user      User     @relation(fields: [userId], references: [id], onDelete: Cascade)
  createdAt DateTime @default(now())

  @@unique([postId, userId])
}

model PostScrap {
  id        String   @id @default(cuid())
  postId    String
  post      Post     @relation(fields: [postId], references: [id], onDelete: Cascade)
  userId    String
  user      User     @relation(fields: [userId], references: [id], onDelete: Cascade)
  createdAt DateTime @default(now())

  @@unique([postId, userId])
}

model Comment {
  id        String   @id @default(cuid())
  content   String
  postId    String
  post      Post     @relation(fields: [postId], references: [id], onDelete: Cascade)
  authorId  String
  author    User     @relation(fields: [authorId], references: [id])
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model Menu {
  id        String     @id @default(cuid())
  key       String     @unique
  name      String
  items     MenuItem[]
  createdAt DateTime   @default(now())
  updatedAt DateTime   @updatedAt
}

model MenuItem {
  id           String   @id @default(cuid())
  menuId       String
  menu         Menu     @relation(fields: [menuId], references: [id], onDelete: Cascade)
  label        String
  href         String
  order        Int      @default(0)
  isVisible    Boolean  @default(true)
  isExternal   Boolean  @default(false)
  openInNew    Boolean  @default(false)
  requiresAuth Boolean  @default(false)
  badgeText    String?
  linkType     String   @default("custom")
  linkedId     String?
  createdAt    DateTime @default(now())
  updatedAt    DateTime @updatedAt

  @@index([menuId, order])
}

model SiteSettings {
  id              String   @id @default(cuid())
  key             String   @unique
  siteName        String?
  siteLogoUrl     String?
  footerEnabled   Boolean  @default(true)
  copyrightText   String?
  showCopyright   Boolean  @default(true)
  termsContent    String?
  termsContentMarkdown String?
  privacyContent  String?
  privacyContentMarkdown String?
  showTerms       Boolean  @default(true)
  showPrivacy     Boolean  @default(true)
  businessLines   Json?
  showBusinessInfo Boolean @default(true)
  socialLinks     Json?
  showSocials     Boolean  @default(true)
  createdAt       DateTime @default(now())
  updatedAt       DateTime @updatedAt
}

model Category {
  id          String   @id @default(cuid())
  name        String
  slug        String   @unique
  description String?
  order       Int      @default(0)
  isVisible   Boolean  @default(true)
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
  products    Product[]
}

model Board {
  id          String   @id @default(cuid())
  key         String   @unique
  name        String
  description String?
  order       Int      @default(0)
  isVisible   Boolean  @default(true)
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
}
